<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Manager Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container-fluid">
    <div class="row">

      <!-- Sidebar -->
      <div class="col-md-3 bg-white border-end vh-100 p-3">
        <h5 class="mb-3">Drivers</h5>
        <ul class="list-group mb-4">
          {{range .DriverSummaries}}
          <li class="list-group-item">
            <a href="/driver/{{.Name}}">{{.Name}}</a>
          </li>
          {{end}}
        </ul>

        <a href="/new-user" class="btn btn-success w-100 mb-2">+ Create New User</a>
        <a href="/assign-routes" class="btn btn-primary w-100 mb-4">Assign Routes</a>

        <h5 class="mb-3">Fleet</h5>
        <ul class="list-group mb-4">
          {{range .Buses}}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            Bus #{{.BusNumber}}
            <span class="badge {{if eq .Status "active"}}bg-success{{else if eq .Status "maintenance"}}bg-warning{{else}}bg-secondary{{end}}">
              {{.Status}}
            </span>
          </li>
          {{end}}
        </ul>

        <h5 class="mb-3">Active Routes</h5>
        <ul class="list-group">
          {{range .RouteStats}}
          <li class="list-group-item">{{.RouteName}}</li>
          {{end}}
        </ul>
      </div>

      <!-- Main Content -->
      <div class="col-md-9 p-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">Manager Dashboard</h2>
          <a href="/logout" class="btn btn-outline-danger">Logout</a>
        </div>

        <h4>Driver Summary</h4>
        <table class="table table-bordered">
          <thead class="table-light">
            <tr>
              <th>Driver</th>
              <th>Morning Attendance</th>
              <th>Evening Attendance</th>
              <th>Total Miles</th>
              <th>Monthly Avg Miles</th>
              <th>Monthly Attendance</th>
            </tr>
          </thead>
          <tbody>
            {{range .DriverSummaries}}
            <tr>
              <td>{{.Name}}</td>
              <td>{{.TotalMorning}}</td>
              <td>{{.TotalEvening}}</td>
              <td>{{printf "%.1f" .TotalMiles}}</td>
              <td>{{printf "%.1f" .MonthlyAvgMiles}}</td>
              <td>{{.MonthlyAttendance}}</td>
            </tr>
            {{end}}
          </tbody>
        </table>

        <h4 class="mt-4">Route Analytics</h4>
        <table class="table table-bordered">
          <thead class="table-light">
            <tr>
              <th>Route</th>
              <th>Total Miles</th>
              <th>Average Miles</th>
              <th>Attendance (Day)</th>
              <th>Attendance (Week)</th>
              <th>Attendance (Month)</th>
            </tr>
          </thead>
          <tbody>
            {{range .RouteStats}}
            <tr>
              <td>{{.RouteName}}</td>
              <td>{{printf "%.1f" .TotalMiles}}</td>
              <td>{{printf "%.1f" .AvgMiles}}</td>
              <td>{{.AttendanceDay}}</td>
              <td>{{.AttendanceWeek}}</td>
              <td>{{.AttendanceMonth}}</td>
            </tr>
            {{end}}
          </tbody>
        </table>

        <h4 class="mt-4">Activities / Field Trips</h4>
        <table class="table table-bordered">
          <thead class="table-light">
            <tr>
              <th>Date</th>
              <th>Driver</th>
              <th>Trip Name</th>
              <th>Attendance</th>
              <th>Miles</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            {{range .Activities}}
            <tr>
              <td>{{.Date}}</td>
              <td>{{.Driver}}</td>
              <td>{{.TripName}}</td>
              <td>{{.Attendance}}</td>
              <td>{{printf "%.1f" .Miles}}</td>
              <td>{{.Notes}}</td>
            </tr>
            {{end}}
          </tbody>
        </table>
      </div>

    </div>
  </div>
</body>
</html>